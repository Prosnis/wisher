import{_ as P,g as B,e as V,r as o,i as F,q as S,f as w,c as _,h as m,a as s,w as C,O as D,P as x,j as p,t as h,m as T,F as W,Q as $,x as I,C as N,o as c}from"./index-DtZ_ybxC.js";import{N as q}from"./NavBar-JqVFmojW.js";import{g as k}from"./GetUserData-DNN_yxwx.js";const z="/wisher/assets/ozon-DIAmpGYW.png",A="/wisher/assets/wb-_uZB1mgy.png",E="/wisher/assets/ym-I_fhSRkn.png",G="/wisher/assets/reserved-DQT6e_Tb.png",Q="/wisher/assets/free-CiGHR2cu.png",j={class:"card"},H={class:"card__user__info skeleton-loader"},L={class:"card__user__info"},M={class:"card__img-wrapper--avatar"},O=["src"],Y={key:0},Z=["href"],J={key:1},K={class:"card__wrapper"},X={class:"card__images"},ss={class:"card__description"},es={class:"card__img__wrapper--description"},as=["src"],ts={class:"card__links"},rs={class:"card__links-wrapper"},os={class:"card__links--item"},is=["href"],ns={class:"card__links--item"},ls=["href"],_s={class:"card__links--item"},cs=["href"],ds={class:"card__description__info"},us={class:"card__description__user"},vs={class:"card__description--actions"},ms={key:0,class:"card__description--reserved"},ps={key:1,class:"card__description--reserved"},hs={__name:"WishCardPreview",setup(gs){const g=B(),f=V(),d=o(!1),a=o({}),R=$(),u=o({}),y=o(!1),i=o(!1),v=o(""),n=o({});F(async()=>{d.value=!0;const l=R.params.uid,e=await S(w(g,"wishes",l)),t=e.exists()?e.data():null;try{if(t){a.value=t,v.value=t.reserve||"",i.value=!!t.reserve;const r=await k(t.userId);u.value=r.user}if(t.reserve){const r=await k(t.reserve);n.value=r.user;const U=f.currentUser;U&&U.uid===n.value.uid&&(y.value=!0)}}catch(r){console.log(r)}finally{d.value=!1}});async function b(){const l=f.currentUser,e=await k(l.uid);i.value&&v.value===l.uid?(await I(w(g,"wishes",a.value.id),{reserve:""}),v.value="",i.value=!1,n.value={}):i.value||(await I(w(g,"wishes",a.value.id),{reserve:f.currentUser.uid}),v.value=l.uid,i.value=!0,n.value=e.user)}return(l,e)=>{const t=N("router-link"),r=N("font-awesome-icon");return c(),_(W,null,[m(q),s("div",j,[C(s("div",H,null,512),[[D,d.value]]),C(s("div",null,[s("div",L,[s("div",M,[s("img",{class:"card__image card__image--user",src:u.value.photoUrl,alt:""},null,8,O)]),m(t,{to:{name:"UserProfile",params:{uid:u.value.uid}},class:"card__user-name"},{default:x(()=>[p(h(u.value.displayName),1)]),_:1},8,["to"]),a.value.link?(c(),_("span",Y,[e[0]||(e[0]=p(" поделился ссылкой ")),s("a",{href:a.value.link,target:"_blank",rel:"noopener noreferrer"},[m(r,{icon:["fas","up-right-from-square"]})],8,Z)])):(c(),_("span",J,"не указал ссылку"))]),s("div",K,[s("div",X,[s("div",ss,[s("div",es,[s("img",{class:"card__image card__image--description",src:a.value.img,alt:""},null,8,as)])]),s("div",ts,[e[4]||(e[4]=s("h3",null,"Найти на маркетплейсах",-1)),s("div",rs,[s("div",os,[s("a",{href:`https://www.ozon.ru/search/?from_global=true&text=${encodeURIComponent(a.value.name)}`,target:"_blank"},e[1]||(e[1]=[s("img",{class:"card__image card__links--img",src:z,alt:""},null,-1)]),8,is)]),s("div",ns,[s("a",{href:`https://www.wildberries.ru/catalog/0/search.aspx?search=${encodeURIComponent(a.value.name)}`,target:"_blank"},e[2]||(e[2]=[s("img",{class:"card__image card__links--img",src:A,alt:""},null,-1)]),8,ls)]),s("div",_s,[s("a",{href:`https://market.yandex.ru/search?text=${encodeURIComponent(a.value.name)}`,target:"_blank"},e[3]||(e[3]=[s("img",{class:"card__image card__links--img",src:E,alt:""},null,-1)]),8,cs)])])])]),s("div",ds,[s("div",us,[s("h1",null,h(a.value.name),1),s("span",null,h(a.value.description),1)]),s("div",vs,[i.value?(c(),_("div",ms,[y.value?(c(),_("button",{key:0,class:"card__button card__button-free",onClick:b}," отказаться ")):T("",!0),e[6]||(e[6]=s("div",null,[s("img",{class:"card__description--stamp",src:G,alt:""})],-1)),s("span",null,[e[5]||(e[5]=p("Зарезервировано пользователем ")),m(t,{to:{name:"UserProfile",params:{uid:n.value.uid}},class:"card__user-name"},{default:x(()=>[p(h(n.value.displayName),1)]),_:1},8,["to"])])])):(c(),_("div",ps,[s("button",{class:"card__button card__button-reserved",onClick:b}," зарезервировать "),e[7]||(e[7]=s("img",{class:"card__description--stamp",src:Q,alt:""},null,-1)),e[8]||(e[8]=s("span",null,"Pарезервируйте этот подарок, если хотите его подарить.",-1))]))])])])],512),[[D,!d.value]])])],64)}}},ys=P(hs,[["__scopeId","data-v-d991e009"]]);export{ys as default};

import{_ as P,d as V,g as B,r as f,A as U,j as h,c as l,l as z,a as t,B as b,m as p,b as F,w as g,v,F as y,t as I,I as M,o as n,q as R,H as A,D as W,u as j,f as q,J as E,z as H}from"./index-CEK05V9V.js";import{W as J}from"./WiNavbar-BZupQX3X.js";import{b as L}from"./UserBadgesStore-wYMTvAUU.js";import{u as T}from"./WiProfileStore-BtBEn_0G.js";const $={class:"form__wrapper"},G={key:0,class:"profile__spinner"},K={class:"form__list"},O={class:"form__list__item"},Q={class:"form__list__item"},X={class:"form__list__item"},Y={class:"form__badge__wrapper"},Z=["onClick"],ss={__name:"UserPageSettingsView",setup(es){const k=V(),w=M(),d=j(),r=T(),x=B(),_=f(!1),i=f(null),{getProfileData:D}=r,a=U({name:r.user.displayName,about:r.user.about,badges:[]}),u=o=>a.badges.some(s=>s.name===o.name),N=o=>{const s=a.badges.findIndex(e=>e.name===o.name);s!==-1?a.badges.splice(s,1):a.badges.push(o)},S=()=>{d.back()},C=async()=>{_.value=!0,i.value=k.currentUser;const o=q(x,"users",i.value.uid),s=await E(o),e=s.exists()?s.data():{},m={displayName:a.name!==""?a.name:i.value.displayName||e.displayName,about:a.about!==""?a.about:i.value.about||e.about,badges:a.badges};try{await H(o,m),console.log("Профиль успешно обновлен")}catch(c){console.error("Ошибка при обновлении профиля:",c)}finally{_.value=!1}d.back()};return h(async()=>{await D(w.params.uid),a.badges=[...r.badges]}),(o,s)=>(n(),l(y,null,[z(J),t("div",$,[_.value?(n(),l("div",G)):b("",!0),p(r).badges.length?(n(),l("form",{key:1,class:"form",onSubmit:F(C,["prevent"])},[s[6]||(s[6]=t("h1",{class:"form__title"}," Редактировать профиль ",-1)),t("ul",K,[t("li",O,[s[2]||(s[2]=t("label",{class:"form__list__label",for:"name"},"Имя:",-1)),g(t("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=e=>a.name=e),class:"form__list__input",type:"text"},null,512),[[v,a.name]])]),t("li",Q,[s[3]||(s[3]=t("label",{class:"form__list__label",for:"about"},"Краткая информация:",-1)),g(t("textarea",{id:"about","onUpdate:modelValue":s[1]||(s[1]=e=>a.about=e),class:"form__list__textarea"},null,512),[[v,a.about]])]),t("li",X,[s[4]||(s[4]=t("label",{class:"form__list__label",for:""},"Выберите интересы:",-1)),t("div",Y,[(n(!0),l(y,null,I(p(L),(e,m)=>(n(),l("div",{key:m,class:R([u(e)?"form__badge__picked":"form__badge"]),style:A({backgroundColor:u(e)?"#0817ecb9":e.BgColor,color:u(e)?"#f0f0f0":"#818c99"}),onClick:c=>N(e)},W(e.name),15,Z))),128))])])]),t("div",{class:"form__buttons"},[t("button",{class:"form__button form__button--decline",type:"button",onClick:S}," отмена "),s[5]||(s[5]=t("button",{class:"form__button form__button--save"}," сохранить изменения ",-1))])],32)):b("",!0)])],64))}},ls=P(ss,[["__scopeId","data-v-db2916dd"]]);export{ls as default};

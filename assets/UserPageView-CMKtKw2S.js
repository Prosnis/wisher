import{g as N,f as S,h as B,x as V,_ as U,r as h,o as i,c as l,a,E as L,A as z,z as f,d as b,F as g,q as M,G as P,u as E,l as W,n as e,p as k,m as C,B as x,w as R,H as A,t as y}from"./index-B2m54ijR.js";import{W as I}from"./WiNavbar-qMcUzFTC.js";import{g as F,r as T,u as j,a as q}from"./index.esm2017-BsjP_LMK.js";import{W as G}from"./WiCardCreate-ROcyAjKh.js";import{u as D}from"./WiProfileStore--A81iFL3.js";import"./GetUserData-jCM42mLR.js";const H=N(),O=F(),X=S();async function $(_,u){const t=T(O,u);return await j(t,_),await q(t)}async function J(_,u,t,s){s.value=!0;const p=X.currentUser,d=B(H,"users",p.uid),o={};try{if(t.value){const n=await $(t.value,`avatars/${p.uid}`);o.photoUrl=n,_.photoUrl=n}if(u.value){const n=await $(u.value,`wallpapers/${p.uid}`);o.wallpaperUrl=n,_.wallpaperUrl=n}return await V(d,o),console.log("Профиль успешно обновлен"),{avatarUrl:o.photoUrl,wallpaperUrl:o.wallpaperUrl}}catch(n){console.log("ошибка при загрузке профиля,",n)}finally{s.value=!1}}const K=["src"],Q={key:0,for:"input-wallaper",class:"profile__wallaper-edit"},Y={key:0,class:"profile__spinner"},Z=["src"],ss={key:1,for:"input-avatar",class:"profile__photo profile__photo--edit"},es={__name:"WiUserPagePicturesEdit",props:{user:{type:Object,default:()=>({})},hasEditPermission:{type:Boolean}},setup(_){const u=_,t=h(!1),s=h(!1),p=h(null),d=h(null),o=h(!1),n=h(!1);function v(m,r){const w=r.target.files[0];m==="avatar"?d.value=w:m==="wallpaper"&&(p.value=w),J(u.user,p,d,o)}return(m,r)=>{const w=M("font-awesome-icon");return i(),l(g,null,[a("div",{class:"profile__wallapper",onMouseenter:r[2]||(r[2]=c=>t.value=!0),onMouseleave:r[3]||(r[3]=c=>t.value=!1)},[a("img",{src:u.user.wallpaperUrl,alt:"user-wallpaper",loading:"lazy",class:"profile__wallapper-img",style:L({opacity:n.value?1:0}),onLoad:r[0]||(r[0]=c=>n.value=!0)},null,44,K),t.value&&_.hasEditPermission?(i(),l("label",Q,[a("input",{id:"input-wallaper",class:"profile__input profile__input--wallpaper",type:"file",onChange:r[1]||(r[1]=c=>v("wallpaper",c))},null,32),r[7]||(r[7]=z(" изменить обложку "))])):f("",!0)],32),a("div",{class:"profile__photo-wrapper",onMouseenter:r[5]||(r[5]=c=>s.value=!0),onMouseleave:r[6]||(r[6]=c=>s.value=!1)},[o.value?(i(),l("div",Y)):f("",!0),a("img",{class:"profile__photo",src:u.user.photoUrl,alt:"user-photo",loading:"lazy"},null,8,Z),s.value&&u.hasEditPermission?(i(),l("label",ss,[a("input",{id:"input-avatar",class:"profile__input profile__input--avatar",type:"file",onChange:r[4]||(r[4]=c=>v("avatar",c))},null,32),b(w,{class:"profile__icon profile__icon-edit",icon:["fas","edit"]})])):f("",!0)],32)],64)}}},ts=U(es,[["__scopeId","data-v-db6590c7"]]),os="/wisher/assets/empty-box-D7umrX5t.png",as={class:"whishes__buttons__wrapper"},rs={key:0,class:"wishes__list"},is={class:"whishes__cards"},ls={key:1,class:"wishes__empty"},ns={__name:"WiUserWishes",setup(_){const u=P(),t=D(),{getProfileData:s}=t,p=E();return W(()=>{s(u.params.uid)}),(d,o)=>(i(),l(g,null,[o[3]||(o[3]=a("h2",{class:"whishes__title"}," Список желаний ",-1)),a("div",as,[e(t).hasEditPermission?(i(),l("button",{key:0,class:"whishes__button whishes__button--whish",onClick:o[0]||(o[0]=()=>e(p).push(e(k).cardAdd))}," Добавить желание ")):f("",!0),e(t).hasEditPermission?(i(),l("button",{key:1,class:"whishes__button whishes__button--invitation",onClick:o[1]||(o[1]=()=>e(p).push(e(k).invitationCard))}," Создать открытку ")):f("",!0)]),e(t).wishes.length?(i(),l("section",rs,[a("div",is,[(i(!0),l(g,null,C(e(t).wishes,n=>(i(),x(G,{key:n.id,wish:n,"user-img":e(t).user.photoUrl,"user-name":e(t).user.displayName},null,8,["wish","user-img","user-name"]))),128))])])):(i(),l("div",ls,o[2]||(o[2]=[a("img",{class:"wishes__empty--img",src:os,alt:"empty-box",loading:"lazy"},null,-1),a("p",{class:"wishes__empty--phrase"}," У пользователя пока нет желаний. ",-1)])))],64))}},us=U(ns,[["__scopeId","data-v-d868ae27"]]),ps={class:"user"},_s={class:"skeleton-loader user__info"},cs={class:"user__info"},ds={key:0,class:"profile"},fs={class:"profile__settings"},hs={key:1,class:"profile__settings__permission"},ms={class:"profile__name"},vs={class:"profile__about"},ws={class:"profile__badges"},gs={class:"wishes"},ys={__name:"UserPageView",setup(_){const u=E(),t=P(),s=D(),{getProfileData:p}=s;function d(){const o=t.params.uid;u.push({path:`${k.settings}/${o}`})}return W(async()=>{await p(t.params.uid)}),(o,n)=>(i(),l("div",null,[a("div",null,[b(I)]),a("main",ps,[R(a("div",_s,null,512),[[A,e(s).skeletonLoad]]),a("section",cs,[!e(s).skeletonLoad&&e(s).user&&e(s).user.displayName?(i(),l("div",ds,[b(ts,{user:e(s).user,"has-edit-permission":e(s).hasEditPermission},null,8,["user","has-edit-permission"]),a("div",fs,[e(s).hasEditPermission?(i(),l("button",{key:0,class:"profile__button profile__button--edit",onClick:d}," Редактировать профиль ")):(i(),l("div",hs))]),a("h2",ms,y(e(s).user.displayName),1),a("p",vs,y(e(s).user.about||"Информация о пользователе отсутствует"),1),a("div",ws,[(i(!0),l(g,null,C(e(s).badges,(v,m)=>(i(),l("div",{key:m,class:"badge"},y(v.name),1))),128))])])):f("",!0)]),a("div",gs,[e(s).user?(i(),x(us,{key:0})):f("",!0)])])]))}},Ws=U(ys,[["__scopeId","data-v-6cc9f2c1"]]);export{Ws as default};

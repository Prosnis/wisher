import{_ as P,f as V,g as U,r as f,y as h,l as B,c as r,d as z,a as t,z as b,n as p,b as F,w as g,v,F as y,m as I,H as M,o as l,C as R,E,t as W,u as A,h as H,I as L,x as T}from"./index-6jhAjEIq.js";import{W as $}from"./WiNavbar-kWzukgAC.js";import{b as j}from"./UserBadgesStore-jHlPkzW9.js";import{u as q}from"./WiProfileStore-CAhogC6w.js";const G={class:"form__wrapper"},J={key:0,class:"profile__spinner"},K={class:"form__list"},O={class:"form__list__item"},Q={class:"form__list__item"},X={class:"form__list__item"},Y={class:"form__badge__wrapper"},Z=["onClick"],ss={__name:"UserPageSettingsView",setup(es){const k=V(),x=M(),c=A(),i=q(),w=U(),_=f(!1),n=f(null),{getProfileData:D}=i,a=h({name:"",about:"",badges:[]}),u=o=>a.badges.some(s=>s.name===o.name),C=o=>{const s=a.badges.findIndex(e=>e.name===o.name);s!==-1?a.badges.splice(s,1):a.badges.push(o)},S=()=>{c.back()},N=async()=>{_.value=!0,n.value=k.currentUser;const o=H(w,"users",n.value.uid),s=await L(o),e=s.exists()?s.data():{},m={displayName:a.name!==""?a.name:n.value.displayName||e.displayName,about:a.about!==""?a.about:n.value.about||e.about,badges:a.badges};try{await T(o,m),console.log("Профиль успешно обновлен")}catch(d){console.error("Ошибка при обновлении профиля:",d)}finally{_.value=!1}c.back()};return B(async()=>{await D(x.params.uid),a.badges=[...i.badges]}),(o,s)=>(l(),r(y,null,[z($),t("div",G,[_.value?(l(),r("div",J)):b("",!0),p(i).badges.length?(l(),r("form",{key:1,class:"form",onSubmit:F(N,["prevent"])},[s[6]||(s[6]=t("h1",{class:"form__title"}," Редактировать профиль ",-1)),t("ul",K,[t("li",O,[s[2]||(s[2]=t("label",{class:"form__list__label",for:"name"},"Имя:",-1)),g(t("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=e=>a.name=e),class:"form__list__input",type:"text"},null,512),[[v,a.name]])]),t("li",Q,[s[3]||(s[3]=t("label",{class:"form__list__label",for:"about"},"Краткая информация:",-1)),g(t("textarea",{id:"about","onUpdate:modelValue":s[1]||(s[1]=e=>a.about=e),class:"form__list__textarea",name:""},null,512),[[v,a.about]])]),t("li",X,[s[4]||(s[4]=t("label",{class:"form__list__label",for:""},"Выберите интересы:",-1)),t("div",Y,[(l(!0),r(y,null,I(p(j),(e,m)=>(l(),r("div",{key:m,class:R([u(e)?"form__badge__picked":"form__badge"]),style:E({backgroundColor:u(e)?"#0817ecb9":e.BgColor,color:u(e)?"#f0f0f0":"#818c99"}),onClick:d=>C(e)},W(e.name),15,Z))),128))])])]),t("div",{class:"form__buttons"},[t("button",{class:"form__button form__button--decline",type:"button",onClick:S}," отмена "),s[5]||(s[5]=t("button",{class:"form__button form__button--save"}," сохранить изменения ",-1))])],32)):b("",!0)])],64))}},ls=P(ss,[["__scopeId","data-v-157c7140"]]);export{ls as default};

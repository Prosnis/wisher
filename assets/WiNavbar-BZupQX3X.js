import{d as _,a3 as y,g as k,J as D,f as b,a4 as x,a5 as N,M as S,N as C,R as U,r as g,S as B,_ as I,u as V,y as m,o as c,c as u,a as n,l,x as v,m as r,p as i,n as W,C as $,D as A,B as R}from"./index-CEK05V9V.js";async function q(){try{const s=_();await y(s),window.location.reload(),console.log("Пользователь разлогинен")}catch(s){console.error("Ошибка при разлогинивании:",s)}}const w=k();async function E(s){const a=await D(b(w,"users",s)),e=a.exists()?a.data():null;if(!e)return console.error("Пользователь не найден!"),{user:null,wishes:[]};const o=x(S(w,"wishes"),N("userId","==",s)),p=(await C(o)).docs.map(t=>({id:t.id,...t.data()}));return{user:e,wishes:p}}const F=_(),J=U("user",()=>{const s=g(null),a=g(null),e=async()=>{const{user:o}=await E(s.value);a.value=o};return B(F,o=>{o?(s.value=o.uid,e()):(s.value=null,a.value=null)}),{userUID:s,user:a}}),M={class:"nav"},O={class:"nav__login__text"},P={key:0,class:"user__wrapper"},Q={class:"user__info"},T=["src"],j={class:"user__name"},z={__name:"WiNavbar",setup(s){const a=V(),e=J(),o=_();async function d(){await a.push(`${i.user}/${e.userUID}`)}return(p,t)=>{const h=m("router-link"),f=m("font-awesome-icon");return c(),u("nav",M,[n("div",null,[l(h,{to:r(i).feed,class:"nav__logo"},{default:v(()=>t[1]||(t[1]=[n("span",null,"вишер",-1)])),_:1},8,["to"])]),r(o).currentUser?(c(),u("div",{key:1,class:"user",onClick:d},[r(e).user?(c(),u("div",P,[n("div",Q,[n("img",{class:"user__img",src:r(e).user.photoUrl,alt:""},null,8,T),n("span",j,A(r(e).user.displayName),1)]),n("button",{class:"nav__button",onClick:t[0]||(t[0]=G=>r(q)())},[l(f,{icon:["fas","right-from-bracket"]})])])):R("",!0)])):(c(),W(h,{key:0,to:r(i).register,class:"user"},{default:v(()=>[n("span",O,[t[2]||(t[2]=$("вход/регистрация")),l(f,{icon:["fas","right-to-bracket"]})])]),_:1},8,["to"]))])}}},K=I(z,[["__scopeId","data-v-32bf742f"]]);export{K as W,E as g,J as u};
